# Лабораторная работа №10. Работа с файлами средствами NASM

**ФИО:** Ибрагим Хиссеин Гана  
**Группа:** НПИбд 01-25  
**Вариант:** 16 (последние цифры зачётной книжки: 1132255116)

## Цель работы
Приобретение навыков написания программ для работы с файлами средствами NASM в ОС Linux, изучение системных вызовов для работы с файлами и механизмов управления правами доступа.

## 1. Подготовительный этап

### 1.1. Создание рабочего каталога и файлов
```bash
mkdir ~/work/arch-pc/lab10
cd ~/work/arch-pc/lab10
touch lab10-1.asm readme-1.txt readme-2.txt

https://screenshots/01_initial_files.png

1.2. Подготовка вспомогательного файла
Файл in_out.asm был использован из предыдущих лабораторных работ, так как содержит необходимые функции для ввода/вывода (sprint, sread, slen, quit).

2. Основная программа lab10-1.asm
2.1. Исходный код программы
Программа запрашивает у пользователя строку и записывает её в файл readme.txt.

https://screenshots/02_lab10-1_source.png

2.2. Компиляция и сборка

nasm -f elf lab10-1.asm
ld -m elf_i386 -o lab10-1 lab10-1.o

https://screenshots/03_compilation.png
https://screenshots/04_linking.png

2.3. Тестирование программы

./lab10-1

При запросе программы была введена строка: Hello from NASM Lab 10!

https://screenshots/06_program_test.png

2.4. Проверка созданного файла

ls -l readme.txt
cat readme.txt

Файл успешно создан и содержит введённый текст.

https://screenshots/07_check_readme1.png
https://screenshots/08_check_readme2.png

3. Работа с правами доступа к файлам
3.1. Запрет выполнения файла lab10-1

chmod a-x lab10-1
ls -l lab10-1
./lab10-1

После снятия прав на выполнение, попытка запуска программы завершается ошибкой "Отказано в доступе".

https://screenshots/09_chmod_remove_x.png

3.2. Установка прав доступа по варианту 16
Вариант 16:

Символьный вид: --x r-x -w-

Двоичный вид: 001 010 101 (восьмеричный: 125)

chmod u=x,g=rx,o=w readme-1.txt
chmod 125 readme-2.txt
ls -l readme-*.txt

Права доступа успешно установлены для обоих файлов.

https://screenshots/10_variant_permissions.png

3.3. Проверка восьмеричных значений прав

stat -c "Fichier: %n | Octal: %a" readme-*.txt
Оба файла имеют восьмеричное значение прав 125, что соответствует варианту 16.

https://screenshots/11_octal_verification.png

4. Самостоятельная работа
4.1. Программа name.asm
Программа запрашивает имя пользователя и записывает его в файл name.txt с префиксом "Меня зовут".

https://screenshots/12_name_source.png

4.2. Компиляция и тестирование
nasm -f elf name.asm
ld -m elf_i386 -o name name.o
./name
При запросе программы было введено имя: Ибрахим

https://screenshots/13_name_execution.png


4.3. Проверка результата

ls -l name.txt
cat name.txt
Файл успешно создан и содержит текст: Меня зовут Ибрахим

https://screenshots/14_check_name_txt.png

5. Ответы на вопросы для самопроверки
5.1. Как определяются права доступа к файлу в Unix-подобных ОС?
Права доступа определяются для трёх категорий пользователей:

Владелец (user) — создатель файла

Группа (group) — пользователи, входящие в группу владельца

Остальные (others) — все остальные пользователи системы

Для каждой категории устанавливаются права на чтение (r), запись (w) и выполнение (x).

5.2. Как ОС определяет, является ли файл исполняемым?
ОС определяет исполняемый файл по наличию права на выполнение (x) в правах доступа. Для запуска файла необходимо, чтобы у соответствующей категории пользователей было установлено право x.

5.3. Как разграничить права доступа для различных категорий пользователей?
Для разграничения прав используются:

Символьный формат: chmod u=rwx,g=rx,o=r файл

Восьмеричный формат: chmod 754 файл (rwxr-xr--)

5.4. Номера системных вызовов для работы с файлами:
sys_read — 3

sys_write — 4

sys_open — 5

sys_close — 6

sys_creat — 8

sys_lseek — 19

sys_unlink — 10

5.5. Использование регистров в системных вызовах:
EAX — номер системного вызова

EBX — первый аргумент (дескриптор файла или имя файла)

ECX — второй аргумент (адрес буфера или режим доступа)

EDX — третий аргумент (количество байтов или права доступа)

5.6. Что такое дескриптор файла?
Дескриптор файла — это уникальный числовой идентификатор (16-битное целое число), который операционная система присваивает открытому файлу. Дескриптор используется для всех последующих операций с файлом через системные вызовы.

6. Выводы
В ходе выполнения лабораторной работы были приобретены практические навыки работы с файлами в ассемблере NASM:

Изучены системные вызовы Linux для работы с файлами: создание, открытие, чтение, запись и закрытие файлов.

Освоена работа с дескрипторами файлов — ключевыми идентификаторами для файловых операций.

Получен опыт компиляции и сборки NASM-программ под архитектуру i386.

Изучены механизмы управления правами доступа в Linux, включая символьную и восьмеричную нотацию.

Реализована автономная программа, взаимодействующая с пользователем и файловой системой.

Работа продемонстрировала эффективность использования системных вызовов для низкоуровневых операций с файлами и важность правильного управления правами доступа в многопользовательской системе.

text

